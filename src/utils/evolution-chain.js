const data = {
  evolution_details: [],
  evolves_to: [
    {
      evolution_details: [
        {
          gender: null,
          held_item: null,
          item: {
            name: 'water-stone',
            url: 'https://pokeapi.co/api/v2/item/84/',
          },
          known_move: null,
          known_move_type: null,
          location: null,
          min_affection: null,
          min_beauty: null,
          min_happiness: null,
          min_level: null,
          needs_overworld_rain: false,
          party_species: null,
          party_type: null,
          relative_physical_stats: null,
          time_of_day: '',
          trade_species: null,
          trigger: {
            name: 'use-item',
            url: 'https://pokeapi.co/api/v2/evolution-trigger/3/',
          },
          turn_upside_down: false,
        },
      ],
      evolves_to: [],
      is_baby: false,
      species: {
        name: 'vaporeon',
        url: 'https://pokeapi.co/api/v2/pokemon-species/134/',
      },
    },
    {
      evolution_details: [
        {
          gender: null,
          held_item: null,
          item: {
            name: 'thunder-stone',
            url: 'https://pokeapi.co/api/v2/item/83/',
          },
          known_move: null,
          known_move_type: null,
          location: null,
          min_affection: null,
          min_beauty: null,
          min_happiness: null,
          min_level: null,
          needs_overworld_rain: false,
          party_species: null,
          party_type: null,
          relative_physical_stats: null,
          time_of_day: '',
          trade_species: null,
          trigger: {
            name: 'use-item',
            url: 'https://pokeapi.co/api/v2/evolution-trigger/3/',
          },
          turn_upside_down: false,
        },
      ],
      evolves_to: [],
      is_baby: false,
      species: {
        name: 'jolteon',
        url: 'https://pokeapi.co/api/v2/pokemon-species/135/',
      },
    },
    {
      evolution_details: [
        {
          gender: null,
          held_item: null,
          item: {
            name: 'fire-stone',
            url: 'https://pokeapi.co/api/v2/item/82/',
          },
          known_move: null,
          known_move_type: null,
          location: null,
          min_affection: null,
          min_beauty: null,
          min_happiness: null,
          min_level: null,
          needs_overworld_rain: false,
          party_species: null,
          party_type: null,
          relative_physical_stats: null,
          time_of_day: '',
          trade_species: null,
          trigger: {
            name: 'use-item',
            url: 'https://pokeapi.co/api/v2/evolution-trigger/3/',
          },
          turn_upside_down: false,
        },
      ],
      evolves_to: [],
      is_baby: false,
      species: {
        name: 'flareon',
        url: 'https://pokeapi.co/api/v2/pokemon-species/136/',
      },
    },
    {
      evolution_details: [
        {
          gender: null,
          held_item: null,
          item: null,
          known_move: null,
          known_move_type: null,
          location: null,
          min_affection: null,
          min_beauty: null,
          min_happiness: 160,
          min_level: null,
          needs_overworld_rain: false,
          party_species: null,
          party_type: null,
          relative_physical_stats: null,
          time_of_day: 'day',
          trade_species: null,
          trigger: {
            name: 'level-up',
            url: 'https://pokeapi.co/api/v2/evolution-trigger/1/',
          },
          turn_upside_down: false,
        },
      ],
      evolves_to: [],
      is_baby: false,
      species: {
        name: 'espeon',
        url: 'https://pokeapi.co/api/v2/pokemon-species/196/',
      },
    },
    {
      evolution_details: [
        {
          gender: null,
          held_item: null,
          item: null,
          known_move: null,
          known_move_type: null,
          location: null,
          min_affection: null,
          min_beauty: null,
          min_happiness: 160,
          min_level: null,
          needs_overworld_rain: false,
          party_species: null,
          party_type: null,
          relative_physical_stats: null,
          time_of_day: 'night',
          trade_species: null,
          trigger: {
            name: 'level-up',
            url: 'https://pokeapi.co/api/v2/evolution-trigger/1/',
          },
          turn_upside_down: false,
        },
      ],
      evolves_to: [],
      is_baby: false,
      species: {
        name: 'umbreon',
        url: 'https://pokeapi.co/api/v2/pokemon-species/197/',
      },
    },
    {
      evolution_details: [
        {
          gender: null,
          held_item: null,
          item: null,
          known_move: null,
          known_move_type: null,
          location: {
            name: 'eterna-forest',
            url: 'https://pokeapi.co/api/v2/location/8/',
          },
          min_affection: null,
          min_beauty: null,
          min_happiness: null,
          min_level: null,
          needs_overworld_rain: false,
          party_species: null,
          party_type: null,
          relative_physical_stats: null,
          time_of_day: '',
          trade_species: null,
          trigger: {
            name: 'level-up',
            url: 'https://pokeapi.co/api/v2/evolution-trigger/1/',
          },
          turn_upside_down: false,
        },
        {
          gender: null,
          held_item: null,
          item: null,
          known_move: null,
          known_move_type: null,
          location: {
            name: 'pinwheel-forest',
            url: 'https://pokeapi.co/api/v2/location/375/',
          },
          min_affection: null,
          min_beauty: null,
          min_happiness: null,
          min_level: null,
          needs_overworld_rain: false,
          party_species: null,
          party_type: null,
          relative_physical_stats: null,
          time_of_day: '',
          trade_species: null,
          trigger: {
            name: 'level-up',
            url: 'https://pokeapi.co/api/v2/evolution-trigger/1/',
          },
          turn_upside_down: false,
        },
        {
          gender: null,
          held_item: null,
          item: null,
          known_move: null,
          known_move_type: null,
          location: {
            name: 'kalos-route-20',
            url: 'https://pokeapi.co/api/v2/location/650/',
          },
          min_affection: null,
          min_beauty: null,
          min_happiness: null,
          min_level: null,
          needs_overworld_rain: false,
          party_species: null,
          party_type: null,
          relative_physical_stats: null,
          time_of_day: '',
          trade_species: null,
          trigger: {
            name: 'level-up',
            url: 'https://pokeapi.co/api/v2/evolution-trigger/1/',
          },
          turn_upside_down: false,
        },
        {
          gender: null,
          held_item: null,
          item: null,
          known_move: null,
          known_move_type: null,
          location: null,
          min_affection: null,
          min_beauty: null,
          min_happiness: null,
          min_level: null,
          needs_overworld_rain: false,
          party_species: null,
          party_type: null,
          relative_physical_stats: null,
          time_of_day: '',
          trade_species: null,
          trigger: {
            name: 'level-up',
            url: 'https://pokeapi.co/api/v2/evolution-trigger/1/',
          },
          turn_upside_down: false,
        },
        {
          gender: null,
          held_item: null,
          item: {
            name: 'leaf-stone',
            url: 'https://pokeapi.co/api/v2/item/85/',
          },
          known_move: null,
          known_move_type: null,
          location: null,
          min_affection: null,
          min_beauty: null,
          min_happiness: null,
          min_level: null,
          needs_overworld_rain: false,
          party_species: null,
          party_type: null,
          relative_physical_stats: null,
          time_of_day: '',
          trade_species: null,
          trigger: {
            name: 'use-item',
            url: 'https://pokeapi.co/api/v2/evolution-trigger/3/',
          },
          turn_upside_down: false,
        },
      ],
      evolves_to: [],
      is_baby: false,
      species: {
        name: 'leafeon',
        url: 'https://pokeapi.co/api/v2/pokemon-species/470/',
      },
    },
    {
      evolution_details: [
        {
          gender: null,
          held_item: null,
          item: null,
          known_move: null,
          known_move_type: null,
          location: {
            name: 'sinnoh-route-217',
            url: 'https://pokeapi.co/api/v2/location/48/',
          },
          min_affection: null,
          min_beauty: null,
          min_happiness: null,
          min_level: null,
          needs_overworld_rain: false,
          party_species: null,
          party_type: null,
          relative_physical_stats: null,
          time_of_day: '',
          trade_species: null,
          trigger: {
            name: 'level-up',
            url: 'https://pokeapi.co/api/v2/evolution-trigger/1/',
          },
          turn_upside_down: false,
        },
        {
          gender: null,
          held_item: null,
          item: null,
          known_move: null,
          known_move_type: null,
          location: {
            name: 'twist-mountain',
            url: 'https://pokeapi.co/api/v2/location/380/',
          },
          min_affection: null,
          min_beauty: null,
          min_happiness: null,
          min_level: null,
          needs_overworld_rain: false,
          party_species: null,
          party_type: null,
          relative_physical_stats: null,
          time_of_day: '',
          trade_species: null,
          trigger: {
            name: 'level-up',
            url: 'https://pokeapi.co/api/v2/evolution-trigger/1/',
          },
          turn_upside_down: false,
        },
        {
          gender: null,
          held_item: null,
          item: null,
          known_move: null,
          known_move_type: null,
          location: {
            name: 'frost-cavern',
            url: 'https://pokeapi.co/api/v2/location/640/',
          },
          min_affection: null,
          min_beauty: null,
          min_happiness: null,
          min_level: null,
          needs_overworld_rain: false,
          party_species: null,
          party_type: null,
          relative_physical_stats: null,
          time_of_day: '',
          trade_species: null,
          trigger: {
            name: 'level-up',
            url: 'https://pokeapi.co/api/v2/evolution-trigger/1/',
          },
          turn_upside_down: false,
        },
        {
          gender: null,
          held_item: null,
          item: null,
          known_move: null,
          known_move_type: null,
          location: null,
          min_affection: null,
          min_beauty: null,
          min_happiness: null,
          min_level: null,
          needs_overworld_rain: false,
          party_species: null,
          party_type: null,
          relative_physical_stats: null,
          time_of_day: '',
          trade_species: null,
          trigger: {
            name: 'level-up',
            url: 'https://pokeapi.co/api/v2/evolution-trigger/1/',
          },
          turn_upside_down: false,
        },
        {
          gender: null,
          held_item: null,
          item: {
            name: 'ice-stone',
            url: 'https://pokeapi.co/api/v2/item/885/',
          },
          known_move: null,
          known_move_type: null,
          location: null,
          min_affection: null,
          min_beauty: null,
          min_happiness: null,
          min_level: null,
          needs_overworld_rain: false,
          party_species: null,
          party_type: null,
          relative_physical_stats: null,
          time_of_day: '',
          trade_species: null,
          trigger: {
            name: 'use-item',
            url: 'https://pokeapi.co/api/v2/evolution-trigger/3/',
          },
          turn_upside_down: false,
        },
      ],
      evolves_to: [],
      is_baby: false,
      species: {
        name: 'glaceon',
        url: 'https://pokeapi.co/api/v2/pokemon-species/471/',
      },
    },
    {
      evolution_details: [
        {
          gender: null,
          held_item: null,
          item: null,
          known_move: null,
          known_move_type: {
            name: 'fairy',
            url: 'https://pokeapi.co/api/v2/type/18/',
          },
          location: null,
          min_affection: 2,
          min_beauty: null,
          min_happiness: null,
          min_level: null,
          needs_overworld_rain: false,
          party_species: null,
          party_type: null,
          relative_physical_stats: null,
          time_of_day: '',
          trade_species: null,
          trigger: {
            name: 'level-up',
            url: 'https://pokeapi.co/api/v2/evolution-trigger/1/',
          },
          turn_upside_down: false,
        },
        {
          gender: null,
          held_item: null,
          item: null,
          known_move: null,
          known_move_type: {
            name: 'fairy',
            url: 'https://pokeapi.co/api/v2/type/18/',
          },
          location: null,
          min_affection: null,
          min_beauty: null,
          min_happiness: 160,
          min_level: null,
          needs_overworld_rain: false,
          party_species: null,
          party_type: null,
          relative_physical_stats: null,
          time_of_day: '',
          trade_species: null,
          trigger: {
            name: 'level-up',
            url: 'https://pokeapi.co/api/v2/evolution-trigger/1/',
          },
          turn_upside_down: false,
        },
      ],
      evolves_to: [],
      is_baby: false,
      species: {
        name: 'sylveon',
        url: 'https://pokeapi.co/api/v2/pokemon-species/700/',
      },
    },
  ],
  is_baby: false,
  species: {
    name: 'eevee',
    url: 'https://pokeapi.co/api/v2/pokemon-species/133/',
  },
};
const data2 = {
  evolution_details: [],
  evolves_to: [
    {
      evolution_details: [
        {
          gender: null,
          held_item: null,
          item: null,
          known_move: null,
          known_move_type: null,
          location: null,
          min_affection: null,
          min_beauty: null,
          min_happiness: null,
          min_level: 25,
          needs_overworld_rain: false,
          party_species: null,
          party_type: null,
          relative_physical_stats: null,
          time_of_day: '',
          trade_species: null,
          trigger: {
            name: 'level-up',
            url: 'https://pokeapi.co/api/v2/evolution-trigger/1/',
          },
          turn_upside_down: false,
        },
      ],
      evolves_to: [
        {
          evolution_details: [
            {
              gender: null,
              held_item: null,
              item: {
                name: 'water-stone',
                url: 'https://pokeapi.co/api/v2/item/84/',
              },
              known_move: null,
              known_move_type: null,
              location: null,
              min_affection: null,
              min_beauty: null,
              min_happiness: null,
              min_level: null,
              needs_overworld_rain: false,
              party_species: null,
              party_type: null,
              relative_physical_stats: null,
              time_of_day: '',
              trade_species: null,
              trigger: {
                name: 'use-item',
                url: 'https://pokeapi.co/api/v2/evolution-trigger/3/',
              },
              turn_upside_down: false,
            },
          ],
          evolves_to: [],
          is_baby: false,
          species: {
            name: 'poliwrath',
            url: 'https://pokeapi.co/api/v2/pokemon-species/62/',
          },
        },
        {
          evolution_details: [
            {
              gender: null,
              held_item: {
                name: 'kings-rock',
                url: 'https://pokeapi.co/api/v2/item/198/',
              },
              item: null,
              known_move: null,
              known_move_type: null,
              location: null,
              min_affection: null,
              min_beauty: null,
              min_happiness: null,
              min_level: null,
              needs_overworld_rain: false,
              party_species: null,
              party_type: null,
              relative_physical_stats: null,
              time_of_day: '',
              trade_species: null,
              trigger: {
                name: 'trade',
                url: 'https://pokeapi.co/api/v2/evolution-trigger/2/',
              },
              turn_upside_down: false,
            },
          ],
          evolves_to: [],
          is_baby: false,
          species: {
            name: 'politoed',
            url: 'https://pokeapi.co/api/v2/pokemon-species/186/',
          },
        },
      ],
      is_baby: false,
      species: {
        name: 'poliwhirl',
        url: 'https://pokeapi.co/api/v2/pokemon-species/61/',
      },
    },
  ],
  is_baby: false,
  species: {
    name: 'poliwag',
    url: 'https://pokeapi.co/api/v2/pokemon-species/60/',
  },
};

const data3 = {
  evolution_details: [],
  evolves_to: [
    {
      evolution_details: [
        {
          gender: null,
          held_item: null,
          item: null,
          known_move: null,
          known_move_type: null,
          location: null,
          min_affection: null,
          min_beauty: null,
          min_happiness: null,
          min_level: 7,
          needs_overworld_rain: false,
          party_species: null,
          party_type: null,
          relative_physical_stats: null,
          time_of_day: '',
          trade_species: null,
          trigger: {
            name: 'level-up',
            url: 'https://pokeapi.co/api/v2/evolution-trigger/1/',
          },
          turn_upside_down: false,
        },
      ],
      evolves_to: [
        {
          evolution_details: [
            {
              gender: null,
              held_item: null,
              item: null,
              known_move: null,
              known_move_type: null,
              location: null,
              min_affection: null,
              min_beauty: null,
              min_happiness: null,
              min_level: 10,
              needs_overworld_rain: false,
              party_species: null,
              party_type: null,
              relative_physical_stats: null,
              time_of_day: '',
              trade_species: null,
              trigger: {
                name: 'level-up',
                url: 'https://pokeapi.co/api/v2/evolution-trigger/1/',
              },
              turn_upside_down: false,
            },
          ],
          evolves_to: [],
          is_baby: false,
          species: {
            name: 'beautifly',
            url: 'https://pokeapi.co/api/v2/pokemon-species/267/',
          },
        },
      ],
      is_baby: false,
      species: {
        name: 'silcoon',
        url: 'https://pokeapi.co/api/v2/pokemon-species/266/',
      },
    },
    {
      evolution_details: [
        {
          gender: null,
          held_item: null,
          item: null,
          known_move: null,
          known_move_type: null,
          location: null,
          min_affection: null,
          min_beauty: null,
          min_happiness: null,
          min_level: 7,
          needs_overworld_rain: false,
          party_species: null,
          party_type: null,
          relative_physical_stats: null,
          time_of_day: '',
          trade_species: null,
          trigger: {
            name: 'level-up',
            url: 'https://pokeapi.co/api/v2/evolution-trigger/1/',
          },
          turn_upside_down: false,
        },
      ],
      evolves_to: [
        {
          evolution_details: [
            {
              gender: null,
              held_item: null,
              item: null,
              known_move: null,
              known_move_type: null,
              location: null,
              min_affection: null,
              min_beauty: null,
              min_happiness: null,
              min_level: 10,
              needs_overworld_rain: false,
              party_species: null,
              party_type: null,
              relative_physical_stats: null,
              time_of_day: '',
              trade_species: null,
              trigger: {
                name: 'level-up',
                url: 'https://pokeapi.co/api/v2/evolution-trigger/1/',
              },
              turn_upside_down: false,
            },
          ],
          evolves_to: [],
          is_baby: false,
          species: {
            name: 'dustox',
            url: 'https://pokeapi.co/api/v2/pokemon-species/269/',
          },
        },
      ],
      is_baby: false,
      species: {
        name: 'cascoon',
        url: 'https://pokeapi.co/api/v2/pokemon-species/268/',
      },
    },
  ],
  is_baby: false,
  species: {
    name: 'wurmple',
    url: 'https://pokeapi.co/api/v2/pokemon-species/265/',
  },
};

const data4 = {
  evolution_details: [],
  evolves_to: [
    {
      evolution_details: [
        {
          gender: null,
          held_item: null,
          item: null,
          known_move: null,
          known_move_type: null,
          location: null,
          min_affection: null,
          min_beauty: null,
          min_happiness: null,
          min_level: 16,
          needs_overworld_rain: false,
          party_species: null,
          party_type: null,
          relative_physical_stats: null,
          time_of_day: '',
          trade_species: null,
          trigger: {
            name: 'level-up',
            url: 'https://pokeapi.co/api/v2/evolution-trigger/1/',
          },
          turn_upside_down: false,
        },
      ],
      evolves_to: [
        {
          evolution_details: [
            {
              gender: null,
              held_item: null,
              item: null,
              known_move: null,
              known_move_type: null,
              location: null,
              min_affection: null,
              min_beauty: null,
              min_happiness: null,
              min_level: 32,
              needs_overworld_rain: false,
              party_species: null,
              party_type: null,
              relative_physical_stats: null,
              time_of_day: '',
              trade_species: null,
              trigger: {
                name: 'level-up',
                url: 'https://pokeapi.co/api/v2/evolution-trigger/1/',
              },
              turn_upside_down: false,
            },
          ],
          evolves_to: [],
          is_baby: false,
          species: {
            name: 'venusaur',
            url: 'https://pokeapi.co/api/v2/pokemon-species/3/',
          },
        },
      ],
      is_baby: false,
      species: {
        name: 'ivysaur',
        url: 'https://pokeapi.co/api/v2/pokemon-species/2/',
      },
    },
  ],
  is_baby: false,
  species: {
    name: 'bulbasaur',
    url: 'https://pokeapi.co/api/v2/pokemon-species/1/',
  },
};
console.log(data.evolves_to.length);

function normalizeEvolutionChain({ species, evolves_to }) {
  if (evolves_to.length > 1) {
    return [
      species,
      evolves_to.map(({ species, evolves_to }) => {
        if (evolves_to.length) {
          return [species, evolves_to[0]?.species];
        } else {
          return species;
        }
      }),
    ];
  } else {
    return evolves_to.length
      ? [species, ...normalizeEvolutionChain(evolves_to[0])]
      : [species];
  }
}
//

console.log(normalizeEvolutionChain(data4));

const evolutionRepeat = normalizeEvolutionChain(data4)
  .filter((evolution) => !Array.isArray(evolution))
  .map((evolution) => evolution);

const index = normalizeEvolutionChain(data4).findIndex((elem) =>
  Array.isArray(elem)
);
console.log(normalizeEvolutionChain(data4)[index]);
if (index !== -1) {
  console.log(
    normalizeEvolutionChain(data4)[index]?.map((evolution) =>
      !Array.isArray(evolution)
        ? [...evolutionRepeat, evolution]
        : Array.isArray(evolution)
        ? [evolutionRepeat, evolution.map((evo) => evo)].flat()
        : [...evolutionRepeat, evolution]
    )
  );
} else {
  console.log(normalizeEvolutionChain(data4).map((evolution) => evolution));
}
